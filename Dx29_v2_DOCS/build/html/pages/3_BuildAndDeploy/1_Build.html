

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.1. Build &mdash; Dx29 v2 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.2. Deploy" href="2_Deploy.html" />
    <link rel="prev" title="3. Build &amp; Deploy" href="../3_BuildAndDeploy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Dx29 v2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Dx29 v2</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1_Architecture.html">1. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Architecture/SystemContext.html">1.1. Level 1: System Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Architecture/Containers.html">1.2. Level 2: Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Architecture/Components.html">1.3. Level 3: Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Architecture/Code.html">1.4. Level 4: Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Environments.html">2. Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Environments/1_AKS-DEV.html">2.1. Dev Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Environments/2_AKS-TEST.html">2.2. Test environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Environments/3_AKS-PRO.html">2.3. Prod environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Environments/4_ScriptsCreateAndDeploy.html">2.4. Scripts for create and deploy environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_BuildAndDeploy.html">3. Build &amp; Deploy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3.1. Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Deploy.html">3.2. Deploy</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Automation.html">3.3. Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Locally.html">3.4. Running and working locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_CurrentStatus.html">3.5. Current Status of the environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_CodeGuidelines.html">4. Code Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Dx29 v2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>3.1. Build</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/pages/3_BuildAndDeploy/1_Build.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <img align="right" width="100px" src="../../_images/Foundation29.png"><div class="section" id="build">
<h1>3.1. Build<a class="headerlink" href="#build" title="Permalink to this headline">¶</a></h1>
<p>The images of the different microservices to be used by the Dx29 application will be created with Docker. That is, each functionality is going to be packaged in different containers where we can host all the dependencies that our application needs to be executed: starting with the code itself, the system libraries, the execution environment or any kind of configuration. From outside the container, we don’t need much more.</p>
<p>Containers represent a logical packaging mechanism where applications have everything they need to run. Describing it in a small configuration file. With the advantage of being able to be easily versioned, reused and replicated by other developers or by system administrators who have to scale those applications without needing to know internally how our application works. The Docker file will be enough to adapt the execution environment and configure the server where it will be scaled. From this file, an image can be generated that can be deployed on a server in seconds.</p>
<p>Docker builds images automatically by reading the instructions from a Dockerfile – a text file that contains all commands, in order, needed to build a given image.</p>
<blockquote>
<div><ul class="simple">
<li>A Dockerfile adheres to a specific format and set of instructions.</li>
<li>A Docker image consists of read-only layers each of which represents a Dockerfile instruction. The layers are stacked and each one is a delta of the changes from the previous layer.</li>
</ul>
</div></blockquote>
<img width="800px" src="../../_images/docker_build.png"><p>Consult the following links to work with Docker:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://docs.docker.com/reference/">Docker Documentation</a></li>
<li><a class="reference external" href="https://docs.docker.com/get-started/overview/">Docker get-started guide</a></li>
<li><a class="reference external" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
</ul>
</div></blockquote>
<p>These are the main steps to create the Docker images, starting from the branch of the project appropriate to the environment we want to compile (develop or main):</p>
<p>The first step is to run docker image build. We pass in . as the only argument to specify that it should build using the current directory. This command looks for a Dockerfile in the current directory and attempts to build a docker image as described in the Dockerfile. <code class="docutils literal notranslate"> <span class="pre">docker</span> <span class="pre">image</span> <span class="pre">build</span> <span class="pre">.</span></code></p>
<p>If Dockerfile takes arguments such as ARG app_name, you can pass those arguments into the build command:<code class="docutils literal notranslate"> <span class="pre">docker</span> <span class="pre">image</span> <span class="pre">build</span> <span class="pre">--build-arg</span> <span class="pre">&quot;app_name=MyApp&quot;</span> <span class="pre">.</span></code></p>
<p>If you want to build the app from a different directory than the current on, or if you are managing multiple Dockerfiles in separate directories for different applications which share some common files: Use the -f flag, to specify which dockerfile to build with: <code class="docutils literal notranslate"> <span class="pre">docker</span> <span class="pre">image</span> <span class="pre">build</span> <span class="pre">-f</span> <span class="pre">&quot;MyApp/Dockerfile&quot;</span> <span class="pre">.</span></code></p>
<p>After the docker image has been built, we will then need to tag your image. Tagging is very important in a docker build and release pipeline since it is the only way to differentiate versions of the application. It is common practice to tag your newest images with the latest tag, but this will be insufficient for deploying to Kubernetes since you have to change the tag in the Kubernetes configuration to signal that a new image should be ran. Because of this, in Dx29 projects for test and production environments we must tagging the latest tag of the main branch with the git commit tag with the same version. This way we can tie the docker images back to version control to see what has actually been deployed, and we have a unique identifier for each build. <code class="docutils literal notranslate"> <span class="pre">docker</span> <span class="pre">image</span> <span class="pre">tag</span> <span class="pre">$IMAGE</span> <span class="pre">-t</span> <span class="pre">$VERSION</span> <span class="pre">.</span></code></p>
<p>All these commands can be unified: <code class="docutils literal notranslate"> <span class="pre">docker</span> <span class="pre">image</span> <span class="pre">build</span> <span class="pre">-f</span> <span class="pre">&quot;MyApp/Dockerfile&quot;</span> <span class="pre">-t</span> <span class="pre">$VERSION.</span></code></p>
<p><a class="reference external" href="https://docs.docker.com/engine/reference/commandline/docker/">Here</a> you can consult the Docker commands guide.</p>
<p>Each of the Dx29 projects will have its Dockerfile configured with the necessary parameters to run itself as a Docker container.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2_Deploy.html" class="btn btn-neutral float-right" title="3.2. Deploy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../3_BuildAndDeploy.html" class="btn btn-neutral float-left" title="3. Build &amp; Deploy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Foundation29

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>